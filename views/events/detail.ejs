<%- include('../partials/header-layout') %>

<style>
  .event-detail {
    max-width: 900px;
    margin: 0 auto;
  }

  .event-hero {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 3rem 2rem;
    border-radius: 8px;
    margin-bottom: 2rem;
  }

  .event-hero h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .event-badges {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
  }

  .detail-section {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    margin-bottom: 1.5rem;
  }

  .detail-section h2 {
    color: #2c3e50;
    margin-bottom: 1.5rem;
    border-bottom: 2px solid #3498db;
    padding-bottom: 0.5rem;
  }

  .detail-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .detail-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .detail-item strong {
    color: #7f8c8d;
    font-size: 0.9rem;
    text-transform: uppercase;
  }

  .detail-item span {
    color: #2c3e50;
    font-size: 1.1rem;
  }

  .action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
  }

  .registration-status {
    background: #d4edda;
    color: #155724;
    padding: 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
    text-align: center;
    font-weight: 500;
  }
</style>

<div class="event-detail">
  <a href="/events" class="btn btn-secondary" style="margin-bottom: 1rem"
    >‚Üê –ê—Ä–≥–∞ —Ö—ç–º–∂—ç—ç–Ω“Ø“Ø–¥ —Ä“Ø“Ø –±—É—Ü–∞—Ö</a
  >

  <div class="event-hero">
    <h1><%= event.title %></h1>
    <div class="event-badges">
      <span class="badge badge-warning" style="font-size: 1rem"
        ><%= event.category %></span
      >
      <span class="badge badge-info" style="font-size: 1rem"
        >üë• <%= event.attendee_count %> –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω</span
      >
    </div>
  </div>

  <div class="detail-section">
    <h2>–ê—Ä–≥–∞ —Ö—ç–º–∂—ç—ç–Ω–∏–π –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π</h2>

    <div class="detail-grid">
      <div class="detail-item">
        <strong>üìÖ –≠—Ö–ª—ç—Ö –æ–≥–Ω–æ–æ –±–∞ —Ü–∞–≥</strong>
        <span><%= new Date(event.start_datetime).toLocaleString() %></span>
      </div>

      <% if (event.end_datetime) { %>
      <div class="detail-item">
        <strong>üèÅ –î—É—É—Å–∞—Ö –æ–≥–Ω–æ–æ –±–∞ —Ü–∞–≥</strong>
        <span><%= new Date(event.end_datetime).toLocaleString() %></span>
      </div>
      <% } %>

      <div class="detail-item">
        <strong>üìç –ë–∞–π—Ä—à–∏–ª</strong>
        <span><%= event.location %></span>
      </div>

      <div class="detail-item">
        <strong>üë§ –ó–æ—Ö–∏–æ–Ω –±–∞–π–≥—É—É–ª–∞–≥—á</strong>
        <span><%= event.host_name %></span>
      </div>

      <% if (event.max_attendees) { %>
      <div class="detail-item">
        <strong>üë• –•–∞–º–≥–∏–π–Ω –∏—Ö –æ—Ä–æ–ª—Ü–æ–≥—á</strong>
        <span><%= event.max_attendees %></span>
      </div>
      <% } %>

      <div class="detail-item">
        <strong>üìä –û–¥–æ–æ–≥–∏–π–Ω –±“Ø—Ä—Ç–≥—ç–ª</strong>
        <span><%= event.attendee_count %></span>
      </div>
    </div>

    <% if (event.description) { %>
    <div class="detail-item">
      <strong>üìù –¢–∞–π–ª–±–∞—Ä</strong>
      <p style="margin-top: 0.5rem; line-height: 1.6">
        <%= event.description %>
      </p>
    </div>
    <% } %>
  </div>

  <div class="detail-section">
    <h2>–ë“Ø—Ä—Ç–≥—ç–ª</h2>

    <% if (user) { %> <% if (isRegistered) { %>
    <div class="registration-status">‚úÖ –¢–∞ —ç–Ω—ç –∞—Ä–≥–∞ —Ö—ç–º–∂—ç—ç–Ω–¥ –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω –±–∞–π–Ω–∞!</div>
    <form method="POST" action="/events/<%= event.id %>/unregister">
      <button type="submit" class="btn btn-danger">–ë“Ø—Ä—Ç–≥—ç–ª —Ü—É—Ü–ª–∞—Ö</button>
    </form>
    <% } else { %> <% if (event.max_attendees && event.attendee_count >=
    event.max_attendees) { %>
    <div class="alert alert-error">‚ö†Ô∏è –≠–Ω—ç –∞—Ä–≥–∞ —Ö—ç–º–∂—ç—ç –¥“Ø“Ø—Ä—Å—ç–Ω –±–∞–π–Ω–∞.</div>
    <% } else { %>
    <p>–≠–Ω—ç –∞—Ä–≥–∞ —Ö—ç–º–∂—ç—ç —Å–æ–Ω–∏—Ä—Ö–æ–∂ –±–∞–π–Ω–∞ —É—É? –û–¥–æ–æ –±“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—ç—Ä—ç–π!</p>
    <form method="POST" action="/events/<%= event.id %>/register">
      <button type="submit" class="btn btn-success">–ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö</button>
    </form>
    <% } %> <% } %> <% } else { %>
    <div class="alert alert-error">
      –ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö–∏–π–Ω —Ç—É–ª–¥ <a href="/login">–Ω—ç–≤—Ç—ç—Ä–Ω—ç</a> “Ø“Ø.
    </div>
    <% } %>
  </div>

  <% if (user && event.host_id === user.id) { %>
  <div class="detail-section">
    <h2>–ó–æ—Ö–∏–æ–Ω –±–∞–π–≥—É—É–ª–∞–≥—á–∏–π–Ω “Ø–π–ª–¥–ª“Ø“Ø–¥</h2>
    <div class="action-buttons">
      <a href="/events/<%= event.id %>/edit" class="btn">–ê—Ä–≥–∞ —Ö—ç–º–∂—ç—ç –∑–∞—Å–∞—Ö</a>
      <a href="/host/events/<%= event.id %>/participants" class="btn"
        >–û—Ä–æ–ª—Ü–æ–≥—á–¥—ã–≥ “Ø–∑—ç—Ö</a
      >
      <form
        method="POST"
        action="/events/<%= event.id %>/delete"
        style="display: inline"
      >
        <button
          type="submit"
          class="btn btn-danger"
          onclick="return confirm('–¢–∞ —ç–Ω—ç –∞—Ä–≥–∞ —Ö—ç–º–∂—ç—ç–≥ —É—Å—Ç–≥–∞—Ö–¥–∞–∞ –∏—Ç–≥—ç–ª—Ç—ç–π –±–∞–π–Ω–∞ —É—É?')"
        >
          –ê—Ä–≥–∞ —Ö—ç–º–∂—ç—ç —É—Å—Ç–≥–∞—Ö
        </button>
      </form>
    </div>
  </div>
  <% } %>
</div>

<%- include('../partials/footer-layout') %>
